# ğŸš€ Item 46 ìŠ¤íŠ¸ë¦¼ì—ì„œëŠ” ë¶€ì‘ìš© ì—†ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë¼ 


Item 46ì˜ 3ì¤„ ìš”ì•½

1. ìŠ¤íŠ¸ë¦¼ ì—°ì‚°ì— ê±´ë„¤ì§€ëŠ” í•¨ìˆ˜ ê°ì²´ëŠ” ë¶€ìˆ˜íš¨ê³¼ê°€ ì—†ì–´ì•¼í•œë‹¤.
2. forEachëŠ” ìŠ¤íŠ¸ë¦¼ì´ ìˆ˜í–‰í•œ ê³„ì‚° ê²°ê³¼ë¥¼ ë³´ê³ í•  ë•Œë§Œ ì´ìš©í•´ì•¼ í•œë‹¤.
3. ìŠ¤íŠ¸ë¦¼ì„ ì˜¬ë°”ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ìˆ˜ì§‘ê¸°ë¥¼ ì˜ ì•Œì•„ë‘¬ì•¼ í•œë‹¤.


## 1. ìŠ¤íŠ¸ë¦¼ ì—°ì‚°ì— ê±´ë„¤ì§€ëŠ” í•¨ìˆ˜ ê°ì²´ëŠ” ë¶€ìˆ˜íš¨ê³¼ê°€ ì—†ì–´ì•¼í•œë‹¤.


ì—¬ê¸°ì„œ ë§í•˜ëŠ” ë¶€ìˆ˜íš¨ê³¼ê°€ ì—†ë‹¤ëŠ” ê²ƒì€ í•´ë‹¹ í•¨ìˆ˜ê°€ ì™¸ë¶€ ìƒíƒœë¥¼ ë³€ê²½í•˜ì§€ ë§ì•„ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
ì´ëŠ” í•¨ìˆ˜ê°€ ì…ë ¥ì„ ë°›ì•„ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ë™ì•ˆ ì™¸ë¶€ ë³€ìˆ˜ë‚˜ ê°ì²´ì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.


ê·¸ëŸ¬ë‹¤ë©´ ì±…ì— ë‚˜ì˜¨ ì˜ˆì œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

```java
File file = new File("C:\\Users\\sim\\effectiveJava\\testFile.txt"); 

Map<String, Long> freq = new HashMap<>(); 

try(Stream<String> words = new Scanner(file).tokens()) { 
	words.forEach(word -> 
		freq.merge(word.toLowerCase(), 1L, Long::sum);
	});
} 

```


í˜„ì¬ forEach ë‚´ë¶€ì—ì„œ ì™¸ë¶€ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ” ëŒë‹¤ë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

---

### â“ì™œ ì™¸ë¶€ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ë©´ ì•ˆë ê¹Œ?


ìŠ¤íŠ¸ë¦¼ ì—°ì‚°ì´ ë³¸ì§ˆì ìœ¼ë¡œ ë³‘ë ¬ì²˜ë¦¬ë¥¼ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ ë˜ì—ˆê¸° ë•Œë¬¸ì— ì™¸ë¶€ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ” ë¡œì§ì´ í¬í•¨ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**1ï¸âƒ£ ìŠ¤ë ˆë“œ ì•ˆì •ì„± ë¬¸ì œ**
**2ï¸âƒ£ ê²½ìŸ ì¡°ê±´**
**3ï¸âƒ£ ë³‘ë ¬ì„±ì˜ ì¥ì  ìƒì‹¤**
**4ï¸âƒ£ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ì›ì¹™ ìœ„ë°°**


#### 1ï¸âƒ£ ìŠ¤ë ˆë“œ ì•ˆì •ì„± ë¬¸ì œ

ë§Œì•½ ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì™¸ë¶€ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ë ¤ê³  ì‹œë„í•œë‹¤ë©´, ë™ì‹œì„± ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ìŠ¤íŠ¸ë¦¼ ì—°ì‚°ì€ ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ë™ì‹œì— ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ì˜ ì¼ê´€ì„±ê³¼ ì •í™•ì„±ì„ ë³´ì¥í•  ìˆ˜ ì—†ê²Œ ë§Œë“­ë‹ˆë‹¤.


#### 2ï¸âƒ£ ê²½ìŸ ì¡°ê±´

ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì¼í•œ ìì›ì— ë™ì‹œì— ì ‘ê·¼í•˜ë ¤ê³  í•  ë•Œ, ê·¸ ìì›ì˜ ìƒíƒœë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, í•œ ìŠ¤ë ˆë“œê°€ ë§µì— ê°’ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´, ìµœì¢… ê²°ê³¼ëŠ” ìŠ¤ë ˆë“œ ì‹¤í–‰ ìˆœì„œì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### 3ï¸âƒ£ ë³‘ë ¬ì„±ì˜ ì¥ì  ìƒì‹¤

ì™¸ë¶€ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ëŒë‹¤ë¥¼ ì‚¬ìš©í•˜ë©´ ìŠ¤íŠ¸ë¦¼ì˜ ë³‘ë ¬ ì²˜ë¦¬ ì´ì ì„ ì œëŒ€ë¡œ í™œìš©í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì™¸ë¶€ ìì›ì— ëŒ€í•œ ì ‘ê·¼ì„ ë™ê¸°í™”í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
ì´ë¡œ ì¸í•´ ë³‘ë ¬ ìŠ¤íŠ¸ë¦¼ì´ ì‹¤ì œë¡œëŠ” ìˆœì°¨ ìŠ¤íŠ¸ë¦¼ë³´ë‹¤ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### 4ï¸âƒ£ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ì›ì¹™ ìœ„ë°°

javaì˜ ìŠ¤íŠ¸ë¦¼ apiëŠ” í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ì„ ë”°ë¥´ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì—ì„œëŠ” ë¶ˆë³€ì„±ê³¼ ìƒíƒœì—†ìŒì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.
ì™¸ë¶€ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ” í–‰ìœ„ëŠ” ì´ëŸ¬í•œ ì›ì¹™ì— ë°˜í•©ë‹ˆë‹¤.

---

ì ê·¸ë ‡ë‹¤ë©´ ë‹¤ì‹œ ëŒì•„ì™€ì„œ ê·¸ëŸ¼ forEach ëŒ€ì‹ ì— ë¬´ì—‡ì„ ì‚¬ìš©í–ˆì„ ê¹Œìš”?

```java
File file = new File("C:\\Users\\sim\\effectiveJava\\\usecase1\\myFile.txt");

Map<String, Long> freq = new HashMap<>(); 

try(Stream<String> words = new Scanner(file).tokens()) { 
	freq = words.collect(groupingBy(String::toLowerCase, counting()));
}
```

groupingByë¥¼ í™œìš© í–ˆìŠµë‹ˆë‹¤.

ì´ì²˜ëŸ¼ ê³„ì‚°ì„ í• ë•ŒëŠ” forEachë³´ë‹¤ëŠ” ìƒí™©ì— ì•Œë§ëŠ” collector ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì‹œëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.
forEachëŠ” ê³„ì‚°ë³´ë‹¤ëŠ” ê³„ì‚° ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ê±°ë‚˜ ë³´ê³ í•  ë•Œë§Œ ì‚¬ìš©í•´ì•¼í•©ë‹ˆë‹¤.


## 3. ìŠ¤íŠ¸ë¦¼ì„ ì˜¬ë°”ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ìˆ˜ì§‘ê¸°ë¥¼ ì˜ ì•Œì•„ë‘¬ì•¼ í•œë‹¤.

ê·¸ëŸ¼ collector ë©”ì„œë“œì—ëŠ” ì–´ë–¤ ê²ƒë“¤ì´ ìˆì„ê¹Œìš”?


**java.util.stream.Collectors**

![](https://i.imgur.com/ENVU01n.png)

Collectorsì—ëŠ” í˜„ì¬ 50ê°œê°€ ë„˜ëŠ” ë©”ì„œë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.  
ëŒ€í‘œì ìœ¼ë¡œ toList(), toSet(), toCollection(collectionFactory)ê°€ ìˆìœ¼ë©° ì´ëŠ” ê°ê° ë¦¬ìŠ¤íŠ¸, ì§‘í•©, í”„ë¡œê·¸ë˜ë¨¸ê°€ ì§€ì •í•œ ì»¬ë ‰ì…˜ íƒ€ì…ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

ì±…ì—ì„œëŠ” ì¤‘ìš”í•œ ìˆ˜ì§‘ê¸° íŒ©í„°ë¦¬ëŠ” toList, toSet, ToMap, groupingBy, joiningì´ë¼ ì†Œê°œí•˜ê³  ìˆìŠµë‹ˆë‹¤.
ì—¬ê¸°ì„œëŠ” toMapê³¼, groupingByì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

## ğŸ’ toMap

ë¦¬ìŠ¤íŠ¸ì™€ ê°™ì€ ì»¬ë ‰ì…˜ì„ ë§µìœ¼ë¡œ ë³€í™˜í•  ë•Œ ì‚¬ìš©

![](https://i.imgur.com/74jspfM.png)


### 1. ê¸°ë³¸ toMap 

ì´ í˜•íƒœëŠ” ë¦¬ìŠ¤íŠ¸ì˜ ìš”ì†Œë¥¼ í‚¤ì™€ ê°’ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë§µìœ¼ë¡œ ìˆ˜ì§‘í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ë°©ë²•ì…ë‹ˆë‹¤.

```java
Map<Integer, String> map = list.stream()
    .collect(Collectors.toMap(Item::getId, Item::getName));

```

### 2. ì¤‘ë³µ í‚¤ ì²˜ë¦¬ë¥¼ ìœ„í•œ toMap

ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¤‘ë³µëœ í‚¤ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê²½ìš°, ì„¸ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ ë³‘í•© í•¨ìˆ˜ë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤.

```java
Map<Integer, String> map = list.stream()
    .collect(Collectors.toMap(Item::getId, Item::getName, (existing, replacement) -> existing));

```

- `(existing, replacement) -> existing`: í‚¤ê°€ ì¤‘ë³µë  ë•Œ ê¸°ì¡´ ê°’ì„ ìœ ì§€í•˜ê³  ìƒˆ ê°’ì„ ë¬´ì‹œí•˜ëŠ” ë³‘í•© í•¨ìˆ˜.

### 3. ë§µ êµ¬í˜„ì„ ì§€ì •í•˜ëŠ” toMap

ê¸°ë³¸ì ìœ¼ë¡œ `toMap`ì€ `HashMap`ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ë‹¤ë¥¸ ë§µ êµ¬í˜„ì„ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ ë„¤ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ ë§µ ê³µê¸‰ìë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
Map<Integer, String> map = list.stream()
    .collect(Collectors.toMap(Item::getId, Item::getName, (existing, replacement) -> existing, TreeMap::new));

```
- `TreeMap::new`: ê²°ê³¼ ë§µì´ `TreeMap`ì´ ë˜ë„ë¡ ì§€ì •.


>ì „ì²´ ì˜ˆì œ
```java
class Item {
    private int id;
    private String name;

    public Item(int id, String name) {
        this.id = id;
        this.name = name;
    }

    public int getId() {
        return id;
    }

    public String getName() {
        return name;
    }
}

public class ToMapExample {
    public static void main(String[] args) {
        List<Item> list = Arrays.asList(
            new Item(1, "apple"),
            new Item(2, "banana"),
            new Item(3, "orange")
        );

        // ê¸°ë³¸ toMap ì‚¬ìš©
        Map<Integer, String> map1 = list.stream()
            .collect(Collectors.toMap(Item::getId, Item::getName));
        System.out.println(map1);

        // ì¤‘ë³µ í‚¤ ì²˜ë¦¬ë¥¼ ìœ„í•œ toMap
        List<Item> listWithDuplicates = Arrays.asList(
            new Item(1, "apple"),
            new Item(1, "banana")
        );
        Map<Integer, String> map2 = listWithDuplicates.stream()
            .collect(Collectors.toMap(Item::getId, Item::getName, (existing, replacement) -> existing));
        System.out.println(map2);

        // ë§µ êµ¬í˜„ì„ ì§€ì •í•˜ëŠ” toMap
        Map<Integer, String> map3 = list.stream()
            .collect(Collectors.toMap(Item::getId, Item::getName, (existing, replacement) -> existing, TreeMap::new));
        System.out.println(map3);
    }
}

```



### ğŸ’ groupingBy

ë°ì´í„° ê·¸ë£¹í™”í•  ë•Œ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.

![](https://i.imgur.com/djsT5Tu.png)

####  1. ê¸°ë³¸ `groupingBy` ì‚¬ìš©

ê°€ì¥ ê°„ë‹¨í•œ í˜•íƒœë¡œ, ê°ì²´ë¥¼ íŠ¹ì • ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”í•©ë‹ˆë‹¤.

```java
import java.util.*;
import java.util.stream.Collectors;

class Item {
    private String category;
    private String name;

    public Item(String category, String name) {
        this.category = category;
        this.name = name;
    }

    public String getCategory() {
        return category;
    }

    public String getName() {
        return name;
    }

    @Override
    public String toString() {
        return name;
    }
}

public class GroupingByExample {
    public static void main(String[] args) {
        List<Item> items = Arrays.asList(
            new Item("Fruit", "Apple"),
            new Item("Fruit", "Banana"),
            new Item("Vegetable", "Carrot"),
            new Item("Vegetable", "Broccoli")
        );

        Map<String, List<Item>> groupedByCategory = items.stream()
            .collect(Collectors.groupingBy(Item::getCategory));
        
        System.out.println(groupedByCategory);
        // {Fruit=[Apple, Banana], Vegetable=[Carrot, Broccoli]}
    }
}
```

- **Item í´ë˜ìŠ¤**: ì¹´í…Œê³ ë¦¬ì™€ ì´ë¦„ì„ ê°€ì§„ ê°„ë‹¨í•œ ì•„ì´í…œ í´ë˜ìŠ¤.
- **groupingBy ì‚¬ìš©**: `Item` ê°ì²´ë¥¼ ì¹´í…Œê³ ë¦¬(`category`)ë³„ë¡œ ê·¸ë£¹í™”.


#### 2. ë‹¤ì¤‘ ë ˆë²¨ ê·¸ë£¹í™” ì˜ˆì œ

ë‘ ë²ˆì§¸ ìˆ˜ì¤€ì˜ ê·¸ë£¹í™”ë¥¼ ì¶”ê°€í•˜ì—¬ ë” ë³µì¡í•œ ê·¸ë£¹í™”ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
import java.util.*;
import java.util.stream.Collectors;

class Item {
    private String category;
    private String name;
    private String type;

    public Item(String category, String name, String type) {
        this.category = category;
        this.name = name;
        this.type = type;
    }

    public String getCategory() {
        return category;
    }

    public String getName() {
        return name;
    }

    public String getType() {
        return type;
    }

    @Override
    public String toString() {
        return name;
    }
}

public class MultiLevelGroupingExample {
    public static void main(String[] args) {
        List<Item> items = Arrays.asList(
            new Item("Fruit", "Apple", "Citrus"),
            new Item("Fruit", "Banana", "Non-Citrus"),
            new Item("Vegetable", "Carrot", "Root"),
            new Item("Vegetable", "Broccoli", "Flower")
        );

        Map<String, Map<String, List<Item>>> groupedByCategoryAndType = items.stream()
            .collect(Collectors.groupingBy(Item::getCategory, 
                    Collectors.groupingBy(Item::getType)));
        
        System.out.println(groupedByCategoryAndType);
        // {Fruit={Citrus=[Apple], Non-Citrus=[Banana]}, Vegetable={Root=[Carrot], Flower=[Broccoli]}}
    }
}
```

- **ë‹¤ì¤‘ ë ˆë²¨ ê·¸ë£¹í™”**: `category`ì™€ `type`ìœ¼ë¡œ ë‘ ë‹¨ê³„ ê·¸ë£¹í™”.

#### 3.  ê·¸ë£¹í™” í›„ í†µê³„ ë˜ëŠ” ë‹¤ë¥¸ ì‘ì—… ìˆ˜í–‰

ê·¸ë£¹í™”ëœ ê²°ê³¼ì— ëŒ€í•´ ì¶”ê°€ì ì¸ ì‘ì—…(ì˜ˆ: ì¹´ìš´íŒ…)ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
import java.util.*;
import java.util.stream.Collectors;

class Item {
    private String category;
    private String name;

    public Item(String category, String name) {
        this.category = category;
        this.name = name;
    }

    public String getCategory() {
        return category;
    }

    public String getName() {
        return name;
    }

    @Override
    public String toString() {
        return name;
    }
}

public class GroupingAndCountingExample {
    public static void main(String[] args) {
        List<Item> items = Arrays.asList(
            new Item("Fruit", "Apple"),
            new Item("Fruit", "Banana"),
            new Item("Vegetable", "Carrot"),
            new Item("Vegetable", "Broccoli"),
            new Item("Fruit", "Orange")
        );

        Map<String, Long> itemCountByCategory = items.stream()
            .collect(Collectors.groupingBy(Item::getCategory, Collectors.counting()));
        
        System.out.println(itemCountByCategory);
        // {Fruit=3, Vegetable=2}
    }
}
```

- **í†µê³„ ì‘ì—…**: ê·¸ë£¹í™” í›„ ê° ì¹´í…Œê³ ë¦¬ì˜ ì•„ì´í…œ ê°œìˆ˜ë¥¼ ì¹´ìš´íŠ¸.


## ğŸ“š ì •ë¦¬

1. ìŠ¤íŠ¸ë¦¼ ì—°ì‚°ì— ê±´ë„¤ì§€ëŠ” í•¨ìˆ˜ ê°ì²´ëŠ” ë¶€ìˆ˜íš¨ê³¼ê°€ ì—†ì–´ì•¼í•œë‹¤.
2. forEachëŠ” ìŠ¤íŠ¸ë¦¼ì´ ìˆ˜í–‰í•œ ê³„ì‚° ê²°ê³¼ë¥¼ ë³´ê³ í•  ë•Œë§Œ ì´ìš©í•´ì•¼ í•œë‹¤.
3. ìŠ¤íŠ¸ë¦¼ì„ ì˜¬ë°”ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ìˆ˜ì§‘ê¸°ë¥¼ ì˜ ì•Œì•„ë‘¬ì•¼ í•œë‹¤.
